server:
  port: 18881
  # 静态资源路径配置
  servlet:
    context-path: /

spring:
  application:
    name: sql-performance-analyzer
  
  # 禁用DevTools自动重启功能
  devtools:
    restart:
      enabled: false
    livereload:
      enabled: false
  
  # H2 数据源（用于缓存SQL分析结果，JPA使用）
  # 使用TCP服务器模式，支持多客户端访问
  # 数据库文件存储在H2服务器的/opt/h2-data目录下

  
  # JPA 配置（用于H2缓存数据库）
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    database-platform: org.hibernate.dialect.H2Dialect
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
        format_sql: true
        # 禁用对序列的检查（H2不需要）
        use_sql_comments: false
    defer-datasource-initialization: true
  datasource:
    url: jdbc:h2:file:./data/sql-analysis-cache;AUTO_SERVER=TRUE
    driver-class-name: org.h2.Driver
    username: sa
    password:
  
  # H2 控制台（明确禁用）
  h2:
    console:
      enabled: false

  # 多数据源配置（用于SQL分析，通过自定义配置类管理）
  datasources:
    configs:
      - name: mysql-primary
        url: jdbc:mysql://127.0.0.1:3306/test_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
        username: root
        password: password
        driver-class-name: com.mysql.cj.jdbc.Driver
        hikari:
          maximum-pool-size: 10
          minimum-idle: 5
          connection-timeout: 30000
          idle-timeout: 600000
          max-lifetime: 1800000
          leak-detection-threshold: 60000

      - name: mysql-secondary
        url: jdbc:mysql://127.0.0.1:3306/test_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
        username: root
        password: password
        driver-class-name: com.mysql.cj.jdbc.Driver
        hikari:
          maximum-pool-size: 10
          minimum-idle: 5
          connection-timeout: 30000
          idle-timeout: 600000
          max-lifetime: 1800000
          leak-detection-threshold: 60000

  # 多大模型配置（使用 Spring AI OpenAI starter，因为 DeepSeek API 兼容 OpenAI）
  llms:
    configs:
      - name: deepseek1
        type: openai
        api-key: sk-f251ef2a739746d394fb1df3935bb06f
        base-url: https://api.deepseek.com
        model: deepseek-chat
        temperature: 0.7
      - name: deepseek2
        type: openai
        api-key: sk-f251ef2a739746d394fb1df3935bb06f
        base-url: https://api.deepseek.com
        model: deepseek-chat
        temperature: 0.7

# MyBatis 配置
mybatis:
  # Mapper XML 文件位置
  mapper-locations: 
    - classpath*:com/example/mapper/*.xml
    - classpath*:mapper/**/*.xml
  # MyBatis 配置文件名（可选，如果不存在可以注释掉）
  # config-location: classpath:mybatis-config.xml
  # 类型别名包路径（可选）
  type-aliases-package: com.example.model

logging:
  level:
    root: DEBUG
    com.example.sqlanalyzer: DEBUG
    jdk.internal.httpclient: INFO
    sun.rmi: INFO
    com.zaxxer: INFO
    javax: INFO


